# HEARTBEAT.md - å¿ƒè·³æ£€æŸ¥é…ç½®

## ä¸Šä¸‹æ–‡æ¸…ç†ç­–ç•¥ï¼ˆä¼˜å…ˆçº§æœ€é«˜ï¼‰
- **å®šæ—¶æ¸…ç†**: æ¯å¤© 2 æ¬¡ï¼ˆ2:00, 14:00ï¼‰ - é€šè¿‡ cron è‡ªåŠ¨æ‰§è¡Œ
- **é˜ˆå€¼æ¸…ç†**: è¶…è¿‡ 50% æ—¶è‡ªåŠ¨è§¦å‘ - åœ¨ heartbeat ä¸­æ‰§è¡Œ
- **æ¸…ç†è„šæœ¬**: `/root/clawd/scripts/backup-and-flush-memory.sh`
- **æ£€æŸ¥è„šæœ¬**: `/root/clawd/scripts/check-context-usage.sh`
- **çŠ¶æ€è·Ÿè¸ª**: `/root/clawd/memory/heartbeat-state.json`

### æ¸…ç†è§¦å‘æ—¶æœº
1. **å®šæ—¶æ¸…ç†**ï¼ˆè‡ªåŠ¨ï¼‰ï¼š
   - æ¯å¤© 2:00 å’Œ 14:00
   - æ— æ¡ä»¶æ‰§è¡Œ

2. **é˜ˆå€¼æ¸…ç†**ï¼ˆæ™ºèƒ½ï¼‰ï¼š
   - æ¯æ¬¡ heartbeat æ—¶æ£€æŸ¥
   - ä¼°ç®—ä½¿ç”¨çŽ‡è¶…è¿‡ 50% æ—¶è§¦å‘
   - é¿å…ä¸€å¤©å†…æ¸…ç†å¤ªé¢‘ç¹

3. **æ‰‹åŠ¨æ¸…ç†**ï¼ˆå¯é€‰ï¼‰ï¼š
   - éšæ—¶å¯ä»¥æ‰‹åŠ¨è¿è¡Œæ¸…ç†è„šæœ¬
   - `bash /root/clawd/scripts/backup-and-flush-memory.sh`

## å¿ƒè·³æ£€æŸ¥æµç¨‹

### ç¬¬ 1 æ­¥ï¼šä¸Šä¸‹æ–‡ä½¿ç”¨çŽ‡æ£€æŸ¥ï¼ˆä¼˜å…ˆï¼‰
```bash
# æ£€æŸ¥å½“å‰ä¸Šä¸‹æ–‡ä½¿ç”¨çŽ‡
bash /root/clawd/scripts/check-context-usage.sh

# è¿™ä¸ªè„šæœ¬ä¼šï¼š
# 1. ä¼°ç®—ä¸Šä¸‹æ–‡ä½¿ç”¨çŽ‡
# 2. å¦‚æžœè¶…è¿‡ 50%ï¼Œè‡ªåŠ¨è§¦å‘æ¸…ç†
# 3. è®°å½•åˆ°æ—¥å¿—
```

### ç¬¬ 2 æ­¥ï¼šæ·±å¤œæ¨¡å¼æ£€æŸ¥
- **å®‰é™æ—¶æ®µ**: 23:00 - 07:00 (Asia/Shanghai)
- **é€šçŸ¥æ¸ é“**: é£žä¹¦å’Œ Slack
- **å½“å‰æ—¶é—´æ£€æŸ¥**: åœ¨æ‰§è¡Œä»»ä½•é€šçŸ¥ä»»åŠ¡å‰ï¼Œå…ˆæ£€æŸ¥å½“å‰æ—¶é—´

## æ—¶é—´åˆ¤æ–­é€»è¾‘
```python
import datetime
from datetime import timezone

def is_night_mode():
    """åˆ¤æ–­å½“å‰æ˜¯å¦åœ¨æ·±å¤œæ¨¡å¼ï¼ˆ23:00-07:00ï¼‰"""
    now = datetime.datetime.now(timezone.utc).astimezone(
        datetime.timezone(datetime.timedelta(hours=8))
    )
    hour = now.hour
    return hour >= 23 or hour < 7

def should_notify():
    """åˆ¤æ–­å½“å‰æ—¶é—´æ˜¯å¦å¯ä»¥å‘é€é€šçŸ¥"""
    return not is_night_mode()
```

## æ·±å¤œæ¨¡å¼æ£€æŸ¥æµç¨‹

### å¿ƒè·³æŽ¥æ”¶æ—¶çš„å¤„ç†
1. **å…ˆè¿è¡Œä¸Šä¸‹æ–‡ä½¿ç”¨çŽ‡æ£€æŸ¥**ï¼ˆä¼˜å…ˆçº§æœ€é«˜ï¼‰
2. å¦‚æžœè¶…è¿‡ 50%ï¼Œè§¦å‘æ¸…ç†
3. ç„¶åŽè¿è¡Œæ·±å¤œæ¨¡å¼æ£€æŸ¥
4. å¦‚æžœè¿”å›žéžé›¶ç ï¼ˆæ·±å¤œæ¨¡å¼ï¼‰ï¼Œåˆ™ï¼š
   - è®°å½•åˆ°æ—¥å¿—ï¼š"[æ—¶é—´] æ·±å¤œæ¨¡å¼ï¼Œè·³è¿‡é€šçŸ¥"
   - å›žå¤ï¼šHEARTBEAT_OK
   - ä¸æ‰§è¡Œä»»ä½•é€šçŸ¥ç›¸å…³çš„æ£€æŸ¥
5. å¦‚æžœè¿”å›žé›¶ç ï¼ˆç™½å¤©ï¼‰ï¼Œåˆ™ï¼š
   - ç»§ç»­æ‰§è¡Œä»¥ä¸‹æ£€æŸ¥

## å¿ƒè·³æ£€æŸ¥ä»»åŠ¡ï¼ˆä»…åœ¨ç™½å¤©æ‰§è¡Œï¼‰
- Email æ£€æŸ¥
- Calendar äº‹ä»¶æé†’ï¼ˆ<2hï¼‰
- Twitter/social é€šçŸ¥
- Weather æ›´æ–°
- ClawdHub Token çŠ¶æ€æ£€æŸ¥ï¼ˆæ¯ 24 å°æ—¶ä¸€æ¬¡ï¼‰
- æˆå°±ç³»ç»Ÿè¿›åº¦æ£€æŸ¥ï¼ˆæ¯ 4 å°æ—¶ä¸€æ¬¡ï¼‰
- AI æç¤ºè¯è‡ªåŠ¨åŒ–æµç¨‹ï¼ˆæ¯å¤©æ—©ä¸Š 9 ç‚¹ï¼Œé€šè¿‡ cron è‡ªåŠ¨æ‰§è¡Œï¼‰

## æ·±å¤œç›‘å·¥ä»»åŠ¡ï¼ˆ23:00-07:00ï¼‰
- **å®¡æŸ¥ä»£ç†æ£€æŸ¥**: ä½¿ç”¨ `/root/clawd/scripts/check-review-agent.sh` æ£€æŸ¥ review-agent å’Œ achievement-system-dev çš„çŠ¶æ€
- **AI ä¿¡æ¯æœç´¢**: ä½¿ç”¨ searXNG æœç´¢ AI ç›¸å…³ä¿¡æ¯ï¼Œåˆ†æžå¹¶ä¿å­˜åˆ° `/root/clawd/memory/ai-research/`
- **å­ä»£ç†ç›‘å·¥**: ç¡®ä¿ achievement-system-dev æ­£å¸¸å·¥ä½œï¼Œå·¥å…·å¯ç”¨
- **è¿›åº¦è®°å½•**: å°†å‘çŽ°çš„é—®é¢˜å’Œè¿›å±•è®°å½•åˆ° daily memory

## æ·±å¤œæ¨¡å¼ä¾‹å¤–
- ç´§æ€¥äº‹ä»¶
- å®‰å…¨è­¦æŠ¥
- ç”¨æˆ·æ˜Žç¡®è¦æ±‚çš„é€šçŸ¥
- **AI ç ”ç©¶ä»»åŠ¡**ï¼ˆjack æŽˆæƒï¼Œä½¿ç”¨ searXNG æœç´¢ AI ç›¸å…³ä¿¡æ¯ï¼‰
- **å®¡æŸ¥ä»£ç†ç›‘ç£**ï¼ˆæ£€æŸ¥å­ä»£ç†å¼€å‘è¿›åº¦ï¼‰

## ðŸ“Š ç™½å¤©æ£€æŸ¥ä»»åŠ¡è¯¦ç»†è¯´æ˜Ž

### æˆå°±ç³»ç»Ÿè¿›åº¦æ£€æŸ¥ï¼ˆæ¯ 4 å°æ—¶ï¼‰
```bash
# æ£€æŸ¥è„šæœ¬
/root/clawd/scripts/check-achievement-progress.sh

# æ£€æŸ¥å†…å®¹
1. å­ä»£ç†çŠ¶æ€ï¼ˆachievement-system-devï¼‰
2. ç»ˆç«¯å·¥å…·å¼€å‘è¿›åº¦
3. æˆå°±æ•°æ®æ”¶é›†çŠ¶æ€
4. å‘é€è¿›åº¦æŠ¥å‘Šåˆ° Slack/Feishu
```

### ClawdHub Token çŠ¶æ€æ£€æŸ¥ï¼ˆæ¯ 24 å°æ—¶ï¼‰
```bash
# æ£€æŸ¥è„šæœ¬
/root/clawd/scripts/check-clawdhub-token-auto.sh

# æ£€æŸ¥å†…å®¹
1. Token æ˜¯å¦æœ‰æ•ˆï¼ˆé€šè¿‡ clawdhub search æµ‹è¯•ï¼‰
2. è®°å½•åˆ° memory/clawdhub-token-check.log
3. å¦‚æžœæ— æ•ˆï¼Œè®°å½•å‘Šè­¦åˆ° memory/clawdhub-token-alerts.txt
4. Token æœ‰æ•ˆåˆ™é™é»˜ï¼Œæ— æ•ˆåˆ™é€šçŸ¥ç”¨æˆ·æ›´æ–°
```

### AI æç¤ºè¯è‡ªåŠ¨åŒ–æµç¨‹ï¼ˆæ¯å¤©æ—©ä¸Š 9 ç‚¹ï¼‰
```bash
# æ‰§è¡Œè„šæœ¬
/root/clawd/scripts/full-prompt-workflow.sh

# æµç¨‹å†…å®¹
1. æ•°æ®æ”¶é›†ï¼ˆReddit, GitHub, Hacker News, SearXNGï¼‰
2. è½¬æ¢æˆ Skills
3. å‘å¸ƒåˆ° ClawdHub
4. ç”ŸæˆæŠ¥å‘Š
5. åªåœ¨æœ‰æ–°æ•°æ®æ—¶å‘é€é€šçŸ¥åˆ° Slack/Feishu
```

### å·¥å…·å’ŒæŠ€èƒ½ä½¿ç”¨è®°å½•ï¼ˆæŒç»­ï¼‰
```bash
# è®°å½•è„šæœ¬
/root/clawd/scripts/record-tool-usage.sh

# è®°å½•å†…å®¹
1. ä½¿ç”¨äº†å“ªäº›å·¥å…·ï¼ˆcoding-agent, searXNG ç­‰ï¼‰
2. ä½¿ç”¨äº†å“ªäº›æŠ€èƒ½
3. ä»»åŠ¡ç±»åž‹å’Œç»“æžœ
4. ä¿å­˜åˆ° memory/tool-usage/
```

## çŠ¶æ€è·Ÿè¸ª
- è®°å½•æœ€åŽæ£€æŸ¥æ—¶é—´åˆ° `memory/heartbeat-state.json`
- é¿å…é‡å¤é€šçŸ¥åŒä¸€äº‹ä»¶
